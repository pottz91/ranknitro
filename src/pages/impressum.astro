---
import BaseHead from '../components/BaseHead.astro';
import Footer from '../components/Footer.astro';
import Header from '../components/Header.astro';
import { SITE_TITLE, SITE_URL } from '../consts';
import { breadcrumbListSchema, webPageSchema } from '../utils/schema';

const siteUrl = Astro.site?.href ?? SITE_URL;
const pageUrl = new URL('/impressum/', siteUrl).href;
const title = `Impressum – ${SITE_TITLE}`;
const description = 'Impressum und Angaben gemäß § 5 DDG – Potthast Online-Marketing GbR.';
const webPageJsonLd = webPageSchema(siteUrl, pageUrl, title, description);
const breadcrumbJsonLd = breadcrumbListSchema(siteUrl, [
	{ name: 'Start', url: '/' },
	{ name: 'Impressum', url: '/impressum/' },
]);

// Kontaktdaten nur per JS einblenden (gegen Crawler/Spam) – Base64 bei Build
const emailB64 = Buffer.from('info@christopher-potthast.de', 'utf8').toString('base64');
const telDisplayB64 = Buffer.from('+49 176 47624350', 'utf8').toString('base64');
const telHrefB64 = Buffer.from('+4917647624350', 'utf8').toString('base64');
---

<!doctype html>
<html lang="de">
	<head>
		<BaseHead title={title} description={description} noindex />
		<script type="application/ld+json" set:html={JSON.stringify(webPageJsonLd)} />
		<script type="application/ld+json" set:html={JSON.stringify(breadcrumbJsonLd)} />
	</head>
	<body>
		<Header />
		<main class="legal-page">
			<h1>Impressum</h1>
			<p>Angaben gemäß § 5 DDG</p>

			<h2>Potthast Online-Marketing GbR</h2>
			<p>
				Zeissring 9c<br />
				37603 Holzminden<br />
				Deutschland
			</p>

			<h2>Vertreten durch die Gesellschafter</h2>
			<p>
				Constanze Potthast<br />
				Christopher Potthast
			</p>

			<h2>Kontakt</h2>
			<p id="impressum-contact" data-email={emailB64} data-tel-display={telDisplayB64} data-tel-href={telHrefB64}>
				<noscript>Bitte JavaScript aktivieren, um Telefon und E-Mail anzuzeigen.</noscript>
			</p>

			<h2>Umsatzsteuer</h2>
			<p>Umsatzsteuerbefreit gemäß § 19 UStG (Kleinunternehmerregelung)</p>

			<h2>Verantwortlich für den Inhalt nach § 18 Abs. 2 MStV</h2>
			<p>
				Constanze Potthast<br />
				Zeissring 9c<br />
				37603 Holzminden<br />
				Deutschland
			</p>

			<h2>Verbraucherstreitbeilegung</h2>
			<p>
				Wir sind zur Teilnahme an einem Streitbeilegungsverfahren vor einer Verbraucherschlichtungsstelle weder verpflichtet noch bereit.
			</p>
		</main>
		<Footer />
		<script is:inline>
			(function () {
				var el = document.getElementById('impressum-contact');
				if (!el || !el.dataset.email) return;
				try {
					var email = atob(el.dataset.email);
					var telDisplay = atob(el.dataset.telDisplay);
					var telHref = atob(el.dataset.telHref);
					el.innerHTML = 'Telefon: <a href="tel:' + telHref + '">' + telDisplay + '</a><br>E-Mail: <a href="mailto:' + email + '">' + email + '</a>';
				} catch (e) {}
			})();
		</script>
	</body>
</html>
