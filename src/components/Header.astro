---
import HeaderLink from './HeaderLink.astro';
---

<header class="site-header" id="site-header">
	<nav>
		<a href="/" class="logo-link" aria-label="Ranknitro Startseite">
			<img src="/logo.avif" alt="Ranknitro" class="logo logo-light" width="160" height="40" />
			<img src="/logo-dark.avif" alt="Ranknitro" class="logo logo-dark" width="160" height="40" />
		</a>
		<button type="button" class="burger-btn" id="burger-btn" aria-label="Menü öffnen" aria-expanded="false" aria-controls="nav-links">
			<span class="burger-line"></span>
			<span class="burger-line"></span>
			<span class="burger-line"></span>
		</button>
		<div class="nav-links" id="nav-links">
			<HeaderLink href="/">Start</HeaderLink>
			<HeaderLink href="/blog">Blog</HeaderLink>
			<HeaderLink href="/geo-checkliste">GEO-Checkliste</HeaderLink>
			<HeaderLink href="/about">Über uns</HeaderLink>
		</div>
		<a href="#geo-audit" class="cta-btn">Free GEO Audit</a>
	</nav>
</header>

<script>
	(function () {
		const header = document.getElementById('site-header');
		if (!header) return;
		const invertSections = document.querySelectorAll('[data-nav-invert]');
		const navHeight = 80;

		function checkInvert() {
			let overBlack = false;
			invertSections.forEach((el) => {
				const rect = el.getBoundingClientRect();
				if (rect.top < navHeight && rect.bottom > 0) overBlack = true;
			});
			header.classList.toggle('nav-inverted', overBlack);
		}
		window.addEventListener('scroll', checkInvert, { passive: true });
		window.addEventListener('resize', checkInvert);
		checkInvert();

		const burgerBtn = document.getElementById('burger-btn');
		const navLinks = document.getElementById('nav-links');
		if (burgerBtn && navLinks) {
			burgerBtn.addEventListener('click', function () {
				const open = header.classList.toggle('nav-open');
				burgerBtn.setAttribute('aria-expanded', open);
				burgerBtn.setAttribute('aria-label', open ? 'Menü schließen' : 'Menü öffnen');
			});
			navLinks.querySelectorAll('a').forEach(function (link) {
				link.addEventListener('click', function () {
					header.classList.remove('nav-open');
					burgerBtn.setAttribute('aria-expanded', 'false');
					burgerBtn.setAttribute('aria-label', 'Menü öffnen');
				});
			});
			window.addEventListener('resize', function () {
				if (window.innerWidth > 720) {
					header.classList.remove('nav-open');
					burgerBtn.setAttribute('aria-expanded', 'false');
					burgerBtn.setAttribute('aria-label', 'Menü öffnen');
				}
			});
		}
	})();
</script>

<style>
	.site-header {
		position: sticky;
		top: 0;
		z-index: 100;
		background: #FFFFFF;
		border-bottom: 1px solid #000000;
		transition: background 0.2s ease, color 0.2s ease, border-color 0.2s ease;
	}
	.site-header.nav-inverted {
		background: #010208;
		border-bottom-color: #FFFFFF;
	}
	.site-header nav {
		display: flex;
		align-items: center;
		justify-content: space-between;
		max-width: 1200px;
		margin: 0 auto;
		padding: 0.75rem 1.5rem;
		gap: 1rem;
	}
	.logo-link {
		display: flex;
		align-items: center;
		text-decoration: none;
		border: none;
	}
	.logo {
		height: 36px;
		width: auto;
		object-fit: contain;
		display: block;
	}
	.logo-dark {
		display: none;
	}
	.nav-inverted .logo-light {
		display: none;
	}
	.nav-inverted .logo-dark {
		display: block;
	}
	.nav-links {
		display: flex;
		align-items: center;
		gap: 0.25rem;
	}
	.nav-links a {
		padding: 0.5rem 0.75rem;
		font-family: "Montserrat", sans-serif;
		font-weight: 700;
		font-size: 0.9rem;
		color: #010208;
		text-decoration: none;
		border: 2px solid transparent;
	}
	.nav-links a:hover,
	.nav-links a.active {
		text-decoration: underline;
	}
	.site-header.nav-inverted .nav-links a {
		color: #FFFFFF;
	}
	.cta-btn {
		display: inline-block;
		padding: 0.6rem 1.25rem;
		background: #FFFFFF;
		color: #010208;
		font-family: "Montserrat", sans-serif;
		font-weight: 700;
		font-size: 0.9rem;
		text-decoration: none;
		border: 2px solid #010208;
		border-radius: 0;
		transition: background 0.2s ease, color 0.2s ease, border-color 0.2s ease;
	}
	.cta-btn:hover {
		background: #010208;
		color: #FFFFFF;
		border-color: #FFFFFF;
	}
	.site-header.nav-inverted .cta-btn {
		background: #FFFFFF;
		color: #010208;
		border-color: #FFFFFF;
	}
	.site-header.nav-inverted .cta-btn:hover {
		background: #010208;
		color: #FFFFFF;
		border-color: #FFFFFF;
	}
	.burger-btn {
		display: none;
		flex-direction: column;
		justify-content: center;
		gap: 5px;
		width: 44px;
		height: 44px;
		padding: 0;
		border: 2px solid currentColor;
		background: transparent;
		cursor: pointer;
		color: #010208;
		transition: color 0.2s ease, border-color 0.2s ease;
	}
	.burger-btn:hover {
		opacity: 0.85;
	}
	.site-header.nav-inverted .burger-btn {
		color: #FFFFFF;
		border-color: #FFFFFF;
	}
	.burger-line {
		display: block;
		width: 22px;
		height: 2px;
		background: currentColor;
		transition: transform 0.25s ease, opacity 0.25s ease;
	}
	.site-header.nav-open .burger-line:nth-child(1) {
		transform: translateY(7px) rotate(45deg);
	}
	.site-header.nav-open .burger-line:nth-child(2) {
		opacity: 0;
	}
	.site-header.nav-open .burger-line:nth-child(3) {
		transform: translateY(-7px) rotate(-45deg);
	}
	@media (max-width: 720px) {
		.site-header nav {
			flex-wrap: wrap;
			padding: 0.5rem 1rem;
		}
		.burger-btn {
			display: flex;
			order: 2;
			margin-left: auto;
		}
		.nav-links {
			order: 3;
			width: 100%;
			max-height: 0;
			overflow: hidden;
			flex-direction: column;
			align-items: stretch;
			gap: 0;
			justify-content: flex-start;
			transition: max-height 0.3s ease;
		}
		.site-header.nav-open .nav-links {
			max-height: 280px;
			padding-top: 0.5rem;
			padding-bottom: 0.5rem;
		}
		.nav-links a {
			padding: 0.75rem 1rem;
			border-bottom: 1px solid rgba(0, 0, 0, 0.08);
		}
		.site-header.nav-inverted .nav-links a {
			border-bottom-color: rgba(255, 255, 255, 0.2);
		}
		.cta-btn {
			order: 4;
			margin-left: 0;
			width: 100%;
			text-align: center;
		}
	}
</style>
